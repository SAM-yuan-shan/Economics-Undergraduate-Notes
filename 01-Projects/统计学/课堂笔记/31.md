考试
![image.png](https://raw.githubusercontent.com/SAMLAY-c/obsidian-photos/university/img/20250514102736765.png)
# 皮尔逊卡方检验统计量 (Pearson Chi-squared Test Statistic)
图片中显示的公式是计算**皮尔逊卡方 (Pearson $\chi^2$) 检验统计量**，常用于拟合优度检验和列联表中的独立性检验。
## 公式
该检验统计量计算如下：
$$
\chi^2 = \sum_{i=1}^{r} \frac{(O_i - E_i)^2}{E_i}
$$
这个统计量服从自由度为 $(r-1)$ 的卡方分布，记作 $\chi^2(r-1)$。
## 公式各组成部分解释
* **$\chi^2$ (卡方值)**:
    * 这是我们计算得到的检验统计量的值。它衡量的是观察到的频数与期望的频数之间的差异程度。
* **$\sum_{i=1}^{r}$ (求和符号)**:
    * 表示对从 $i=1$ 到 $r$ 的所有类别（或组）进行求和。
    * $r$ 代表数据中分类的总数或组数。
* **$O_i$ (Observed Frequency - 观察频数)**:
    * 代表在第 $i$ 个类别中，我们实际观察到的数据点的数量（频数）。
* **$E_i$ (Expected Frequency - 期望频数)**:
    * 代表在原假设 (null hypothesis) 成立的情况下，我们期望在第 $i$ 个类别中出现的数据点的数量（频数）。
    * 期望频数的计算方法取决于具体的检验类型（例如，在拟合优度检验中，它可能基于一个理论分布；在独立性检验中，它基于边际总计）。
* **$(O_i - E_i)$**:
    * 第 $i$ 个类别的观察频数与期望频数之间的差异。
* **$(O_i - E_i)^2$**:
    * 上述差异的平方。取平方有两个目的：
        1.  消除正负差异的影响，因为我们关心的是差异的大小而不是方向。
        2.  放大较大的差异。
* **$\frac{(O_i - E_i)^2}{E_i}$**:
    * 将第 $i$ 个类别的差异平方除以该类别的期望频数。这样做是为了对差异进行标准化。相对于期望频数较小的差异，即使绝对值相同，也比相对于期望频数较大的差异更为显著。
## 公式的用途
* **衡量差异**: 卡方统计量综合了所有类别中观察值与期望值之间的差异。
* **假设检验**:
    * **值的大小**: $\chi^2$ 的值越大，表明观察到的数据与原假设下的期望值之间的差异越大，也就越有理由拒绝原假设。
    * **P值**: 计算出的 $\chi^2$ 值可以用来找到P值。P值是在原假设为真的前提下，获得当前观察到的结果或更极端结果的概率。如果P值小于预设的显著性水平（如 $\alpha = 0.05$），则拒绝原假设。
    * **分布**: 如公式旁标注的 $\chi^2(r-1)$，该统计量近似服从自由度为 $df = r-1$ 的卡方分布（其中 $r$ 是类别的数量）。
## 图片中的补充说明（重要应用条件）
根据图片中的补充说明，使用皮尔逊 $\chi^2$ 拟合优度检验时需要注意：
1.  **大样本适用**: 该检验主要用于大样本场合，因为它依赖的是渐近分布。
2.  **期望频数的要求**:
    * 在实际应用中，一般要求各类别的**期望频数 ($E_i$) 不小于5**。
    * 如果某些类别的期望频数过小（例如小于5），往往需要将一些相邻的或性质相似的类别进行合并，以满足这一要求。这样做是为了保证卡方分布的近似效果良好。
3.  **多项分布与二项分布**:
    * 上述拟合优度检验是在大样本场合下的多项分布检验（例如检验骰子各点数出现的概率是否均等）。
    * 当类别数 $r=2$ 时，即为二项分布的检验（例如检验抛硬币正反面出现的概率是否符合预期）。
## 总结
皮尔逊卡方检验是一个非常有用的非参数检验方法，它通过比较观察频数和期望频数来判断两者之间是否存在显著差异，从而对分类数据的分布或变量间的关联性进行推断。正确理解和应用其前提条件（尤其是样本大小和期望频数）对于获得可靠的检验结果至关重要。
# 例题
![image.png](https://raw.githubusercontent.com/SAMLAY-c/obsidian-photos/university/img/20250514103109368.png)
# 单样本比例的假设检验：城市老年人口比例问题
## 问题陈述
一项统计结果声称，某市老年人口（年龄在65岁以上）所占的比例为14.7%。该市老年人口研究会为了检验该项统计是否可靠，随机抽取了400名居民，发现其中有57人年龄在65岁以上。调查结果是否支持该市老年人口比例为14.7%的看法？（显著性水平 $\alpha = 0.05$）
## 解题步骤
### 1. 建立假设
我们要检验的是该市老年人口比例是否为14.7%。
* **原假设 (Null Hypothesis, $H_0$)**: 该市老年人口比例等于14.7%。
    $H_0: p = 0.147$
* **备择假设 (Alternative Hypothesis, $H_1$)**: 该市老年人口比例不等于14.7% (这是一个双边检验，因为我们关心的是比例是否“不同于”14.7%，而不是特定方向的差异)。
    $H_1: p \neq 0.147$
### 2. 确定显著性水平 ($\alpha$)
题目中已给出显著性水平。
$\alpha = 0.05$
### 3. 计算样本统计量
* 样本量 ($n$) = 400
* 样本中65岁以上的人数 ($x$) = 57
* 样本比例 ($\hat{p}$):
    $\hat{p} = \frac{x}{n} = \frac{57}{400} = 0.1425$
### 4. 检验条件
为了使用Z检验进行比例检验，我们需要确保样本量足够大，使得样本比例的抽样分布近似于正态分布。通常的条件是：
* $np_0 \ge 10$
* $n(1-p_0) \ge 10$
其中 $p_0$ 是原假设中的总体比例 (0.147)。
* $np_0 = 400 \times 0.147 = 58.8$
* $n(1-p_0) = 400 \times (1 - 0.147) = 400 \times 0.853 = 341.2$
由于 $58.8 \ge 10$ 且 $341.2 \ge 10$，所以满足使用Z检验的条件。
### 5. 计算检验统计量 (Z值)
Z检验统计量的公式为：
$$ Z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}} $$
代入数值：
$$ Z = \frac{0.1425 - 0.147}{\sqrt{\frac{0.147(1-0.147)}{400}}} $$
$$ Z = \frac{-0.0045}{\sqrt{\frac{0.147 \times 0.853}{400}}} $$
$$ Z = \frac{-0.0045}{\sqrt{\frac{0.125391}{400}}} $$
$$ Z = \frac{-0.0045}{\sqrt{0.0003134775}} $$
$$ Z = \frac{-0.0045}{0.0177052955} $$
$$ Z \approx -0.25416 $$
所以，计算得到的检验统计量 $Z \approx -0.254$。
### 6. 确定决策规则（使用临界值法）
由于是双边检验，且显著性水平 $\alpha = 0.05$，我们需要找到两个临界值，它们分别对应标准正态分布左右两侧各 $\alpha/2 = 0.05/2 = 0.025$ 的概率。
查标准正态分布表或使用计算器，可得临界值 $Z_{\alpha/2}$ 为：
$Z_{0.025} \approx \pm 1.96$
**决策规则**:
* 如果计算得到的 $|Z| > 1.96$，则拒绝原假设 $H_0$。
* 如果计算得到的 $|Z| \le 1.96$，则不拒绝原假设 $H_0$。
### 7. 作出统计决策
比较我们计算得到的Z值和临界值：
$|Z_{calculated}| = |-0.254| = 0.254$
因为 $0.254 \le 1.96$，所以我们不拒绝原假设 $H_0$。
*(可选：P值法)*
*我们也可以计算P值。对于双边检验，P值 = $2 \times P(Z < -|Z_{calculated}|)$ 或 $2 \times P(Z > |Z_{calculated}|)$。*
*P值 = $2 \times P(Z < -0.254)$。查标准正态分布表， $P(Z < -0.254) \approx 0.400$ (这个值需要更精确的查找，比如使用R或Python，`2 * pnorm(-0.25416)` 结果约为 0.80)。*
*假设 $P(Z < -0.25416) \approx 0.3996$, 则 P值 $\approx 2 \times 0.3996 = 0.7992$。*
*因为 P值 ($0.7992$) > $\alpha$ ($0.05$)，所以我们不拒绝原假设 $H_0$。*
### 8. 结论解释
在 $\alpha = 0.05$ 的显著性水平下，由于我们计算得到的检验统计量 Z 值 (-0.254) 的绝对值小于临界值 1.96 (或者 P 值大于0.05)，我们没有足够的证据拒绝原假设 $H_0$。
因此，根据这次抽样调查的结果，**我们尚不能认为该市65岁以上老年人口的比例与声称的14.7%有显著差异。调查结果在统计上支持该市老年人口比例为14.7%的看法。**