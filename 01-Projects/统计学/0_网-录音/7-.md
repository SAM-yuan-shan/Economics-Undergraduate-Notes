# 第三章 数据的图表展示

上一章我们学习了数据的搜集，这是数据从无到有的过程。获得原始数据后，在进行正式分析之前，我们通常需要对数据进行**预处理 (Preprocessing)**、**整理 (Organization)** 和**展示 (Presentation)** 这三个步骤。

* **预处理的结果**：是得到干净、可用的数据。
* **整理的结果**：通常是得到结构清晰的**表格 (Tables)**。
* **展示的工具**：主要是各种**图形 (Charts/Graphs)**。

当然，表格和图形都可以理解为数据展示的两种基本形式。本节，我们首先关注**数据的预处理**。

## 第一节 数据的预处理 (Data Preprocessing)

数据预处理就像做菜前要洗菜、淘米一样，是对原材料进行的初步清洗和整理，是进入下一步分析或操作的必要步骤。数据预处理主要包括三个环节：**审核 (Auditing)**、**筛选 (Screening/Filtering)** 和**排序 (Sorting)**。

### 一、数据的审核 (Data Auditing)

数据的初始来源要么是通过调查，要么是通过实验。

* **原始数据 (Original/Primary Data)**：如果调查或实验过程是由研究者**自己完成**的，那么得到的数据称为原始数据。
* **二手数据 (Secondary Data)**：如果调查或实验过程是由**他人完成**的，研究者只是将这些数据拿来使用，则称为二手数据。

对不同来源的数据，审核的侧重点有所不同。

#### 1. 原始数据的审核

对于原始数据，审核主要集中在**完整性 (Completeness)** 和**准确性 (Accuracy)** 两个方面。

假设我们有一份源于对在校生调查的数据表：

| 编号 | 姓名 | 性别 | 年龄 | 身高(cm) | 月收入(元) | 月支出(元) | 特长   |
| :--- | :--- | :--- | :--- | :------- | :--------- | :--------- | :----- |
| 1    | 李明 | 男   | 20   | 175      |            | 1500       | 篮球   |
| 2    | 王芳 | 女   | 19   | 162      | 500        | 1200       |        |
| ...  | ...  | ...  | ...  | ...      | ...        | ...        | ...    |
|      | 张三 |      |      |          |            |            |        |
| ...  | ...  | ...  | ...  | ...      | ...        | ...        | ...    |
| 8    | 赵六 | 男   | 21   | 1.82     | 1000       | 50000      | 编程   |
| 9    | 孙七 | 女   | 20   | 168      | 800        | 2          | 唱歌   |

这份数据表有两个维度：**个体 (Individuals/Cases)**，即每一行代表一个学生；**变量 (Variables)**，即每一列代表一个调查项目。

* **完整性审核 (Completeness Check)**：
    * **个体维度**：检查是否有整个观测对象的遗漏。
        * 例如，表格中“张三”这一行所有数据均为空白，可能表示这个体的数据完全遗漏。
    * **变量维度**：在个体没有遗漏的情况下，审核每个个体各变量的填写是否齐全。
        * 例如，1号学生的“月收入”为空白，2号学生的“特长”为空白，说明这些变量值未能完整填写。

* **准确性审核 (Accuracy Check)**：
    * 审核数据中是否存在明显的**错误 (Errors)** 和**异常值 (Anomalies/Outliers)**。
    * **错误**：
        * 例如，身高单位是厘米(cm)，8号同学身高填为“1.82”。按单位要求，1.82厘米显然是一个错误。这可能是由于记录错误（如单位混淆，应为182cm或1.82m）或填写错误。
    * **异常值**：
        * 例如，月支出单位是元，8号同学月支出为“50000”，9号同学月支出为“2”。这些数值相对于其他同学的支出可能显得极端，我们不能100%确定它们是错误的，但它们肯定是异常的，需要特别关注。
    * **处理原则**：
        * 发现错误或异常值时，**第一反应不是直接删除**。
        * 应首先**设法查明原因**：是数据登记、录入或汇总过程中出错，还是被调查者当初确实就是这样填写的？
        * **确认与修正**：
            * 如果异常数据经过核实确认是**正确的**（例如，某同学月支出确实是50000元），则应**予以保留**。
            * 如果确认是**错误的**，应设法**进行改正**（如通过原始问卷核对，或在可能的情况下重新联系被调查者确认）。

#### 2. 二手数据的审核

对二手数据的审核，其关注点与我们在第二章中讲过的“二手数据的评估”非常相似，主要包括**适用性 (Applicability/Suitability)** 和**时效性 (Timeliness)**。

* **时效性审核**：
    * 评估数据是否已经**过时**。过时的数据可能无法反映事物当前阶段的规律或特征。
    * 例如：研究当下的消费者行为，如果使用网购普及之前的数据，那么这些数据因未能包含线上消费模式而显得过时。

* **适用性审核**：
    * 包括对数据的**来源 (Source)**、**统计口径 (Caliber)** 和**背景 (Background)** 三个方面的审核。
    * **目的**：
        1.  确保二手数据与当前的研究目的**相匹配**。
        2.  间接或侧面地评估二手数据的**完整性和准确性**。因为二手数据通常已经经过了原始搜集者的初步清洗，我们往往无法直接参与或追溯其最初的调查过程，所以直接、正面地审核其完整性和准确性有时难以做到。

    *(注：对于原始数据，由于是研究者自己为特定目的搜集，其适用性和时效性通常在搜集阶段就已得到保障。)*

### 二、数据的筛选 (Data Screening/Filtering)

* **定义**：根据特定条件，从数据集中找出并提取符合条件的某一部分数据，或剔除不符合条件的数据。
* **应用场景**：
    1.  **数据清洗的后续步骤**：在数据审核阶段，对于那些无法纠正的错误数据、不符合研究要求的无效数据，或者因某些原因无法弥补的缺失数据，可能需要将其从数据集中**删除**。
    2.  **服务于特定研究目的**：
        * 例如，如果数据是通过分层抽样获得的，而研究者希望对每个层进行单独的推断分析，那么就需要筛选出特定层级的样本数据进行操作。

### 三、数据的排序 (Data Sorting)

#### 1. 数据排序的作用

1.  **发现特征或趋势，找到解决问题的线索**：
    * 对数据进行排序后，更容易观察到数据分布的模式、集中的区域、极端值等特征，或者发现某种潜在的规律或趋势。
    * 例如：将全国30多个省市自治区的GDP总量从低到高排序，可能会发现它们自然地分成几个梯队。梯队内部的GDP水平差异较小，而梯队之间的差异较大。这种现象可以引导我们进一步分析造成这种梯队划分的原因，以及各梯队内部的共同点等。
2.  **作为数据审核的一种辅助手段**：
    * 排序可以使数据中的错误或异常值更加显眼。
    * 例如：在之前的学生数据表示例中，如果对“身高(cm)”列进行升序排序，那么“1.82”这个异常（错误）值就会排在最前面，非常容易被发现。
3.  **在某些场合，排序本身就是分析的目的之一**：
    * 例如：各种排行榜的研究，如大学排名、财富排名、票房排名等。研究机构会从多个方面对评价对象进行打分，赋予不同指标相应的权重，计算总分，最后根据总分对所有对象进行排序。这个排名列表本身就是其研究分析的重要成果之一。

#### 2. 数据排序的方法

不同类型的数据，其排序方法有所不同。

* **分类数据 (Categorical Data) 的排序**：
    * 分类数据通常用文字表示不同的类别，这些类别之间本身没有固有的数量顺序或高低贵贱之分（如性别：男、女；颜色：红、黄、蓝）。
    * 其排序**不依据数据本身的内在含义**，而是依据其**文字表现形式**。
        * **字母型数据**（如英文名称）：通常按照字母的升序 (A-Z) 或降序 (Z-A) 排列，习惯上多用升序。
        * **汉字型数据**：可以按照汉字的拼音首字母排序，或者按照笔画数量排序。

* **数值型数据 (Numerical Data) 的排序**：
    * 数值型数据本身就具有明确的大小关系，因此直接按照其数值大小进行排序。
    * **排序与次序统计量 (Order Statistics) 的表示**：
        假设有一组原始（未排序的）数值型数据，包含 $$n$$ 个观测值：$$x_1, x_2, \dots, x_n$$。这里的下标 $$1, 2, \dots, n$$ 仅表示数据被观察或记录的原始顺序，并不代表其数值大小。
        * 例如，一组数据为：$$x_1=5, x_2=8, x_3=7, x_4=1, x_5=3$$。

        * **递增排序 (Ascending Sort)**：将数据从小到大排列。
            $$ x_{(1)} \le x_{(2)} \le \dots \le x_{(n)} $$
            其中：
            * $$x_{(i)}$$ 表示排序后第 $$i$$ 小的数值（称为第 $$i$$ 个次序统计量）。
            * $$x_{(1)}$$ 是最小值。
            * $$x_{(n)}$$ 是最大值。
            对于上述例子，递增排序后为：1, 3, 5, 7, 8。
            则：$$x_{(1)}=1, x_{(2)}=3, x_{(3)}=5, x_{(4)}=7, x_{(5)}=8$$。

        * **递减排序 (Descending Sort)**：将数据从大到小排列。
            $$ x_{(1)} \ge x_{(2)} \ge \dots \ge x_{(n)} $$
            **注意**：课件中对于递减排序，仍然使用 $$x_{(1)}, x_{(2)}, \dots$$ 来表示排序后的序列，此时的含义发生了变化：
            * $$x_{(1)}$$ 变成表示**最大值**。
            * $$x_{(2)}$$ 变成表示第二大的值。
            * $$x_{(n)}$$ 变成表示最小值。
            对于上述例子，递减排序后为：8, 7, 5, 3, 1。
            则（按课件的递减排序表示法）：$$x_{(1)}=8, x_{(2)}=7, x_{(3)}=5, x_{(4)}=3, x_{(5)}=1$$。

        > **【符号解释】**
        > * $$x_i$$：原始数据集中第 $$i$$ 个观测值（按原始顺序）。
        > * $$x_{(i)}$$：排序后（通常指升序）的第 $$i$$ 个位置上的值。括号表示该下标指示的是排序后的位置。
        >   * 在**升序**排列中，$$x_{(1)}$$ 代表**最小值**。
        >   * 在课件所描述的**递减**排列中，$$x_{(1)}$$ 代表**最大值**。使用时需根据上下文明确排序方向。