# Playwright MCP 实现自动表单填写

**来源:** [Bilibili 视频 - 二师兄说AI](https://www.bilibili.com/video/BV1GNZHYAEJS/)
**发布日期:** 2025-03-31 18:19:47
**案例编号:** MCP100 案例之 014

## 概述

本笔记介绍了 Playwright MCP (Model Context Protocol) 工具，重点讲解如何利用它实现网页表单的自动化填写，从而提升工作效率。

## Playwright MCP 简介

*   **定义:** Playwright MCP 是一个提供浏览器自动化能力的服务器，基于强大的 Playwright 技术构建。
*   **核心技术 - Playwright:**
    *   **用途:** 为现代 Web 应用提供可靠的端到端测试。
    *   **语言支持:** TypeScript, Javascript, Python, .NET, Java。
    *   **特性:**
        *   断言专为动态 Web 设计。
        *   检查会自动重试，直至满足条件。

## Playwright MCP 核心特点

*   **快速且轻量级:**
    *   使用 Playwright 的 **可访问性树 (Accessibility Tree)** 而非基于像素的输入，处理表单速度更快。
*   **大型语言模型 (LLM) 友好:**
    *   **无需视觉模型:** 纯粹基于结构化数据运行。
    *   **准确性高:** 避免了基于截图方法常见的歧义性，能更准确地识别和填写表单内容。

## 应用场景

*   **核心应用:** 自动表单填写。
*   **其他应用:**
    *   网页导航。
    *   从结构化内容中提取数据。
    *   进行由 LLM 驱动的自动化测试。
    *   为智能代理提供通用浏览器交互能力。

## 安装与配置

*   **VS Code:** 可通过按钮或命令行安装。
*   **集成:** 安装后，可在 VS Code 中与 GitHub Copilot 代理一起使用。
*   **浏览器配置文件:**
    *   Playwright MCP 会使用新的配置文件启动 Chrome 浏览器。
    *   配置文件位置因操作系统而异。
    *   所有登录信息存储在该配置文件中。
    *   **清除状态:** 可在会话之间删除配置文件以清除离线状态。
*   **特殊运行模式:**
    *   **无头浏览器模式 (Headless):**
        *   无 GUI 界面。
        *   适用于后台或批处理操作。
        *   配置示例需参考文档。
    *   **在无 Display 的 Linux 上运行有头浏览器:**
        *   需要通过端口启用 SSH 传输。
        *   需要在 MCP 客户端配置中设置 SSH 端点。
        *   具体命令需参考文档。

## 交互模式

Playwright MCP 提供两种主要的交互模式：

1.  **快照模式 (Snapshot Mode - 默认):**
    *   **机制:** 使用**可访问性快照 (Accessibility Snapshot)**。
    *   **优点:** 提供更好的性能和可靠性。
    *   **应用:** 在自动表单填写时，能快速准确地识别表单元素。
2.  **视觉模式 (Vision Mode):**
    *   **机制:** 使用截图进行基于视觉的交互。
    *   **启用:** 通过添加 `vision` 标志启用。
    *   **适用场景:** 适合能够基于截图、使用 XY 坐标空间与元素交互的计算机视觉模型。

## 编程使用 (侧重快照模式)

在自动表单填写场景下，主要使用**快照模式**提供的工具：

*   `browser type`: 在可编辑元素中输入文本。
*   `browser select option`: 在下拉菜单中选择选项。
*   (其他相关工具...)

这些工具可以轻松完成表单的各项填写任务。

## 自动表单填写演示流程

1.  **启动项目:** 打开并启动一个项目。
2.  **配置 MCP:**
    *   将 MCP 配置复制到 `.json` 文件中。
    *   参考 GitHub 获取详细配置说明和示例。
3.  **生成表单 (示例):**
    *   借助 DeepSeek V3 (或其他工具/方式) 生成一个网页表单。
    *   将表单内容/结构保存到 JSON 文件中（或直接使用 HTML 文件）。
    *   可以根据个人需求定制 Prompt 或参考示例。
4.  **验证表单:** 确保生成的表单服务正常可用。
5.  **执行自动填写:**
    *   使用 Playwright MCP 工具 (通过 LLM 调用)。
    *   观察 Playwright 工具的执行过程和结果 (`result` 部分)。
    *   MCP 会根据指令准确地在表单中填入数据。
    *   过程快速、准确。

## 核心理念与价值

*   **核心:** 让 LLM 通过**结构化的可访问性快照**与网页交互，**无需依赖截图或视觉模型**。
*   **角色:** 扮演 LLM 和网页之间的桥梁，实现顺畅沟通和协作。
*   **功能:** 不仅仅是表单填写，还可用于自动收集网页信息、自动网页测试等。

## 总结

Playwright MCP 是一个强大的自动化工具，它使得 LLM 能够以结构化、非视觉的方式与网页进行交互。其两种模式提供了灵活性，适用于自动表单填写及其他多种自动化场景，能显著提升工作效率。