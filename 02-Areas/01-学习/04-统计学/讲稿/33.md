大家好，这节课呢，我们进入双因素方差分析顾名思义呢，双因素就是两个因素，在方差分析当中因素是分类变量。所以双因素方差分析研究的是两个分类变量，对一个数值型变量是否有显著影响。那么，双因素方差分析呢？分为两类，一类呢？是无交互作用，一类是有交互作用。那所谓的无交互作用，意思就是两个分类变量，对数值型变量的影响。
是独立的，你影响你的，我影响我的，互不干扰。有交互作用的意思是，除了两个分类变量对数值型变量的，直接的，单独的影响之外。两个因素之间的搭配和组合还会对数值型变量产生新的影响。比如，我们认为地区。呃，和品牌这两个因素都对电视销量有影响，如果我们单独看地区，比如啊，
地区二的销量。更大，如果我们单独看品牌，品牌二的销量更大。但是，地区二和销量二的组合啊，就是这个格子里。它的销量可能反而会更小，这就是交互作用地区对销量的影响，会受到品牌的干扰。地区对销量的影响会随着品牌的变化而变化，或者我们也可以说品牌对于销量的影响会受到地区的影响。品牌对销量的影响会随着地区的变化而变化。我们首先来看无交互作用的双因素方差分析呃，这两张表格呢，
都体现了双因素方差分析的样本数据结构。它是一个矩阵的形式，在这个矩阵当中，有行和列分别代表行因素和列因素。那么行因素和列因素呢？其实是共用一组数据，就是这个矩阵里的全部数据不同的行啊，就是行因素不同，取值下的样本。比如品牌因素啊，它是行因素，它有四个取值品牌，一二三四。那么，这四个品牌呢？
各有一行样本数据。不同的列呢，就是列因素不同，取值或水平下的样本，比如地区因素，有地区一二三四五五个取值。那么，不同的列。就代表不同地区的数据。那么行因素和列因素的不同水平呢？它是交叉的交叉之处啊，比如。地区一。品牌一它的交叉呢，在这个地方。
那么，这个三六五就表示品牌衣在地区衣的销售量。那在左边这个更一般化的数据结构当中，我们把行因素的水平数量也就是行的数量记为k啊，有k行。那么，对列因素的水平数量也就是列的数量，我们记为r啊，有r列那么x ig。表示第I行第基列的观察值。那么，在单因素的方差分析当中，我们要检验一个分类变量，对数值型变量的影响，那我们就只需要一个假设。
但是在双因素当中，在这个没有交互作用的双因素当中，我们要分别对行因素和列因素做假设。对于行因素的假设。原假设是缪一等于缪二一直等于缪k啊，它的直观含义就是k个总体均值是相等的。那它背后的这个实际意义呢？是行因素，对于数值型变量没有显著影响，被则假设呢？是不全相等？含义就是行因素，对于数值型变量有显著影响。比如在这个电视销量的这个例子当中。行因素品牌有四个水平，
品牌一二三四，我们的原假设对于行因素的原假设是缪一等于缪二等于缪三等于缪四。含义就是品牌因素，对于销量没有显著影响。贝德假设是不全相等，那就是含义就是有显著影响。那么，对于劣因素的。假设原假设的直观含义就是k个总体均值是相等的呃，实际意义就是列因素对于数值型变量没有显著影响。倍则假设呢，是不全相等含义，就是列因素对于数值性变量有显著影响。那在右边这个例子当中，我们对列因素也就是地区因素的假设。
列因素有五个水平，那就是缪一二三四五是相等的。含义呢，就是地区因素对于销量没有显著影响，被则假设呢，是不全相等啊，含义就是地区。这个因素对于销量存在显著影响。好，现在我们已经这个熟悉了，数据结构和提出了假设，下一步呢，就是要构造检验统计量。与单因素是类似的，我们构造检验统计量呢，
还是基于总平方和的分解，或者称为总误差的分解？呃，我们先来介绍几种均值，在单因素分析当中呢？呃，我们只需要计算一个因素，不同水平下的样本均值以及总均值。xi点八和x八八要计算这两种均值。在双因素当中呢，因为有行因素和列因素，所以我们要分开计算行因素不同水平下的均值以及列因素不同水平下的均值。以及总的均值，那么因为在这个矩阵当中有行有列，那如果我们对于不同水平下的均值。
还用这种写法的话。我们就没有办法判断这个I到底是di行还是di列，所以我们对于这种矩阵形式的数据计算，行列均值的时候，我们有特殊的符号。用x。把I。点儿啊，这个形形式来表示行因素第I个水平的样本均值。啊，就是在这个矩阵当中，第I个行的样本均值。比如I=2的时候x把二点儿，那就是第二行。它的样本均值我们写在这里。
这是行因素的均值，那么列因素呢？用x八点g来表示，地基列的均值，比如说这个。g=2的时候，那就是x八点二，它表示的是第二列的。均值啊，那也就是这部分数据的均值啊，我们写在这里。那对应到右边这个例子当中呢？x八一点，它代表第一行的均值，那就是第一行这五个数字加起来除以五。
就是第一行的均值，那这个x把点二它代表的是第二列的均值，那就是。这四个数字加起来除以四啊，就是第二列的均值，那么总均值呢？是所有的数字加起来嗯，所有的数字加起来。然后除以样本量kr当然了kr。也可以写成n啊，因为我们这个数据是k行r列啊，所以样本量n=kr。在这个双因素无交互作用的这个数据结构当中，这个总的均值啊，按照我们的定义，
刚才说过了，就是所有的数字加起来，再除以样本量kr。就是嗯。呃，这个时候呢，它还有一其它的一种含义，这个总的均值x8。x两个横杠，它既是。行均值的均值，也就是说我们把x八一点儿x八二点儿一直加到。x爸k点全部给它求个和，然后再除以k就是x爸爸就是总均值。那么，
列均值的均值呢？也是一样的含义，我们把它们都加起来，求个和，然后再除以。二就等于总均值啊，这个时候总均值它有这个不同的含义了，它可以是所有。观察值的均值，它还可以是行均值的均值，它还可以是列均值的均值，都是相等的。下面我们来看总平方和具体该如何分解在单因素当中。s ST=ssa+ss e，它的含义是总波动等于组间波动加组内波动。
那么，组间的波动呢？是分类变量可以解释的那一部分，组内波动呢？是剩余的那一部分，在双因素中啊，整体的思路还是一样的。从总波动当中。提取出一个行因素引起的波动啊，或者我们就称为行组间波动。然后再提取一个列因素引起的波动，最后会有一个剩余的波动，这就是对总波动的一个分解。那么，我们提取行列，
最后有一个剩余。那么，提取行因素的呃引起的波动的时候呢？我们就把这个列忽略掉啊，你就全当没有列就可以了，把它当成单因素去提取组间的波动。嗯，你把列忽略掉，它就只剩行因素了，然后这个时候把。它当成单因素去提取组间的波动，行组间的波动就是每行的均值。与总均值之差的平方和。那我们提取列波动的时候呢？提取列波动的时候，
你就权当行的影响不存在，把它当成是一个单因素方差分区去提取组间波动。这个时候提取出来的，其实就是列因素引起的波动，那么这个总波动它是。列均值啊，与总均值之差的平方和。那这个是行因素引起的波动，这个是列因素引起的波动，那么总波动呢？总波动其实与单因素这个总波动没有本质的差异。都是每一个观察值与总均值之差的平方格。我们提取了行。引起的波动提取了列引起的波动，最后呢，
会有一个剩余。那么，这个剩余既不是行引起的，也不是列引起的，是其他因素引起的啊，或者是随机因素引起的。波动那么这个波动啊，比较复杂啊，现在成四项了，那我们在记的时候。是这样的，比如啊，总波动，现在是x ig。与总均值之差，
那么我们提取行因素的时候，波动是如何来的呢？是行的均值与总均值之间的波动列呢？是列的均值。与总均值之间的波动，我们看本来总波动在这里。行，在这里。列在这里，然后我们就。看一下我们这个分解过程当中。少了谁就补上，谁多了谁就减掉谁。比如我们在分解的过程当中，它是等于。
它然后后面呢是剩余啊，剩余那么在这个总的波动当中，本来是有xiz的。但是我们分解这个行和列的时候没有x ig啊，我们就把x ig加上。然后本来总的波动当中是没有行均值和列均值的啊，也就是没有这两个。但是分解的时候，它出现了，我们就把这两个减掉。本来在总的波动当中，是减掉了一个总均值，但是我们分解的时候减掉了一个，又减掉了一个，等于减掉了两个，
所以我们要补一个回来。那这个就是。剩余波动。该如何去构造。那现在我们完成了分解呃，这几个平方和呢，它也有自己的。专有的名称。这个还是叫做s ST总平方和第一个行因素引起的波动ssr。列因素引起的波动ssc剩余的波动还是叫做ss e。哦，它们有一个这样的关系，那么现在我们这个对总平方和进行了一个分解，下一步呢，要计算。
均方啊，计算均方呢，是需要自由度，我们来确定一下各个平方和对应的自由度。那么，总平方和它自由度？还是n- 1。或者我们写成kr- 1啊，这个与单因素的时候的总平方和自由度是一样的。那么行因素引起的这个平方和的自由度，或者是称为行组间平方和的自由度就是行的数量减一。行呢，有k个。减掉一自由度是k- 1，其实这个与我们单因素也是类似的，
单因素当中组件平方和也是。这个因素不同，水平数量减掉一啊，当时我们把呃分类变量不同的取值，也就是因素不同的水平放在了不同的列上。啊，当时就是列数减一，现在呢，我们对应的这个行组间平宽和的自由度。也是一样的啊，它有几个取值？就用这个取值的数量减掉一啊行呢，有k个取值。有k行自由度对应的就是k- 1，那么列因素引起的波动。
它的引起的平方格，它的自由度呢？是r- 1啊，因为有r行。这个跟行这个组间平方和确定自由度逻辑也是一样的。那么最后呢？还剩一个。组内平方和或者称为剩余平方和，它的自由度的问题，那它的自由度呢？我们可以用两种方法，一种就是。总平方和的自由度，它等于呃各个平方和的自由度之和。那么最后这一个呢？
我们可以用。总平方格的自由度，总的自由度是kr- 1，然后减掉。行平方和的自由度，然后再减掉列平方和的自由度。这个式子其实就是组内平方和ss 1的自由度，那么我们可以整理一下。它等于kr-1-k+1-r再加一，那这个时候呢？有两个加一呃等于kr减。k-r再加一。然后这有k我们提出来kr- 1，然后再减去括号r- 1，那么这有r- 1，
这有r- 1 r- 1提出来。二，进一。k- 1啊，这个就是ss e的自由度，或者呢，我们也可以从这个。呃，矩阵或者就是几何的角度去考虑一下这个自由度，总的自由度是kr- 1。也就是现在我们有一个k行r列的矩阵，总的自由度呢，是格子的数量减一，那么这个阴影部分的这个。我们这个小格子，
我们就去掉了，剩下的格子的数量就是总平方和的自由度。然后行因数列，因数和组内会把剩余的小格子全部分掉，那么行因数它的自由度是k- 1，那我们从这开始。给它消掉啊，这正好就是k- 1个。那么，列因素，它的自由度是r- 1，我们就在这给它消掉啊，这个格子数量正好就是r- 1啊，因为。到最后这个是r嘛，
然后少一个正好就是r- 1，那么剩余的部分不就是ss e对应的自由度吗？ss e对应的这个自由度，我们从矩阵的角度来讲，其实就是对这个矩阵删掉了一行，并且删掉了一列，就是这个矩阵瘦了一圈以后。还有多少个格子？那么ss e的自由度就是多少？那它都瘦了一圈，那当然就是行减一乘上。列数建立，那么这个就是ss e的自由度，那么有了自由度以后呢，我们就可以计算均方了就是。
平凡和除，以自己的自由度。平凡和除，以自己的自由度。平凡和除，以自己有自己的自由度。就会产生三个军方。我们来看一下行因素。的均方msr就是ssr除以自己的自由度k- 1，那么行因素呃列因素的均方就是。行就是列因素的平方和除，以自己的自由度ssc÷r- 1，那么。随机误差的军方或者是剩余的军方。或者是我们在单因素当中称为的组内均方就是ss e除，
以自己的自由度，这样我们就会得到三个均方。那这三个军方，其中行因素是msr。随机误差剩余是m se，那我们用msr比上im se就构造了一个。f统计量，它的自由度大家看清楚。分别是k- 1和k- 1×r- 1是f分布的两个自由度。那么，这个时候，由于分子上放的是行因素的均方，所以这样一个统计量，我们来检验的是行因素的假设。跟这个单因素方差分析当中是类似的，
也是做右侧检验。那么列因素呢？我们就用列因素的均方msc比上这个剩余m se。那么，它的自由度r- 1还有这个k- 1×r- 1。那么这两个。f统计量，它的第二自由度是一样的，第一自由度k- 1 r- 1未必是相等的。那么同样的道理，这个msc源自于行的均方，所以我们记为ifc去对列因素。的假设进行检验也是同样的右侧检验，大家一定要注意这个自由度的问题啊。你如果说自由度确定的不准，
你到时候临界值就用错了啊，临界值用错了，以后可能这个结果呃决策的结果就会出错。那我们也可以把这个过程总结到一张表上，称为方差分析表，那这张表呢，就比单因素方差分析表。多了一行的内容，大家要格外注意表格当中体现的这种数量关系，比如。前三个平方和相加等于最后一个平方和前三个自由度相加等于最后一个自由度。平方和除以自己的自由度，会得到均方。f的值呢是均方之b。我们得到这个样本的两个f值以后啊，
与两个自己的这个各自的。临界值做比较，然后做出决策呃，下面呢，我们来看看一下这道例题啊，检验品牌和地区对于电视销量有无显著影响？显著性水平，阿尔法等于零点零五。我们首先要计算啊，各种均值行均值列均值和总均值，那么均值的计算呢，都比较容易，我就直接写在表格里了。那么，关于这个总的均值啊，
虽然它的定义是所有。观察值啊，除以。相加，然后除以n或者是除以。kr.啊，这是它的定义，但是在解题的时候，我们可以先计算得到行均值。比如四个行均值，然后再计算这四个行均值的均值就会得到这个总的均值。当然，也可以先分别计算这各个列的均值，那么这五列均值的五个列均值的均值也是总均值，
那这样操作的时候会方便很多。那么，我们得到了各个均值以后呢？就要计算各个平方和首先呢，是总平方和。它等于一七八八八点儿九五啊，然后。行因素的平方和。这个是它的定义啊，但是我们发现它后面的这一项其实是跟记忆没有关系的。我们就把这个连加符号，直接换成r就可以，就是r倍的后面这个平方，然后把r提到。这个连加符号前面来。
就是这个样子，对于我们这道题来说r是等于五。k呢是四啊，因为k。是行数r，是列数。然后。在计算的时候，我们看里边其实就是各个行的均值与总均值之差的平方和，所以我们计算的时候实际上这个地方展开就是。第一行的均值三百四十四点二，再减掉总均值。括号的平方，然后第二个第二行三百四十七点八。再减掉总均值。
括号的平方加。337。减总均值平方再加二百八十四点八。平方就是后面这个连加。然后前面不要忘了乘以五。这个就是ssr的计算过程，它等于一三零零四点五五。那么ssc呢列因素引起的总的波动。我们看后面这一项，它跟I是没有关系的。所以关于I的连加，我们直接就可以换成k就可以啊，就是这样一个形式，在我们这个例子当中。k=4。
然后鸡翅从一到五。这个计算我们后面的这个连加的计算，那就是从。这是列均值啊，从第一个列均值339减。总均值括号的平方从它开始一直加。三三零点三减总均值的平方，再加一直加到最后是三幺五点五。减去总均值的平方，这个就是后面的这个连加，但是不要忘了前边还要有个四倍。那么，这个最后的结果呢？是二零一一点七。这个我们已经算完了，
总的平方和算完了行因素引起的列因素引起的平方和。那么我们就可以根据这个分解的平方格的关系，直接把ss e求出来，就是s ST。减ssr，减ssc等于这个值呃，因为这个ss e我们看这个公式。它的计算。比s ST要复杂，所以我们这个时候选择一个容易的计算s ST，然后利用它们之间的关系。把ss e解出来就行了啊，没有必要非要正面去计算ss e。那现在各个平方和就计算好了，下一步呢，
就计算均方，那我们写的这个表格里那这几个？呃平方和分别除以自己的自由度相除啊，就会得到对应的均方，然后呢，也会得到两个。f统计量的值啊，第一个是十八点一零八啊，它是四三三四除以二三九得到的。用来与这个临界值做比较，能检验行因素的显著性，那么现在。这个减影统计量的值比这个临界值要大。所以呢，我们就拒绝原言假设。
我们认为品牌对销量有显著影响。那么第二个。统计量值，二点一零一啊，它是。这个由五百零二点二九五除以二三九点三九二得到的我们。用这个检验统计量的值与这个临界值做比较，检验列因素的显著性，那么由于二点一零一啊是小于这个临界值的。所以我们不拒绝演讲社，我们认为地区因素对销量呢，没有显著影响。啊，这个是我们这道题目。后面呢，
我们来看一下这个关系强度。这个呢，与原假设呢呃，与这个单因素呢，就很类似了，就是用因素引起的平方和除。除以总平方和表示因素能够解释的总波动占比，即为r方。那么，在双因素当中呢？因为我们是两个因素嘛，那就要。有行因素引起的平方和也要有列因素引起的平方和，那么这两个平方和相加被称为联合效应。联合效应，
然后我们开方可以得到r用r来衡量两个因素合起来。与数值型变量的关系强度，那么按照我们刚才的呃，这个电视销量的例子r方等于零点八三九四。也就是说，呃，品牌和地区这两个因素。合起来一共解释了销量总波动或者销量总差异的百分之八十三点九四。而其他因素啊，解释了不到17%r呢，就是它的开方。等于零点儿九幺六二表明品牌和地区这两个因素合起来，与销量之间有比较强的关系。那最后呢，我们再来简单介绍一下，
有交互作用的双因素方差分析，先来看一下这个样本的数据结构。双因素呢，必然是有行和列啊，但是在有交互作用的双因素方向分析当中。有行和列还是不够的，行和列的交叉部分不再只有一个观察值啊，而是有多个观察值。比如。列因素一。和行因素一的交叉，它是一个大格子，这个大格子里头不止一个观察值。啊，它是有多个观察值？
那这种样本数据呢？其实是这个呃，可以看成是三维的数据，有行有有长有宽，还有高。所以我们表示，样本观察值的时候呢，下边会有三个，比如xi GL。那么前面的这个I和t会确定。格子是哪一个？也就是说只能定位到格子上啊，比如。这个x一二三那么x一二，它会定位到格子上，
那就是第一行第二列，因为前边的是行，后面的是列。在这里，然后后面的这个三也就是说这个l表示的是什么呢？表示的是你在这个格子里，你是第几个？啊，那么x一二三啊，就是表示行因素。一列因素二这个格子里的第三个。这个是我们表示样本观察值的时候下标的含义。呃，这个是数据结构啊，下面呢，
我们就要构造检验统计量。还是基于这个平方和的分解，那么平方和的分解呢，需要计算各种均值。啊，需要计算各种均值，但是这个均值。包括呃行均值列均值总均值还有格子的。内部的均值，那我们来看一下总均值。那就是x八八。等于sigma sigma sigma，那就是I=1到。到k是行g=1，到r是列l=1，
到m。是格子里的数量。然后xi GL这是。求和，然后除以n就可以，但是这个n呢，我们可以表示成kr m这三者相乘。哦，这是总的均值，那么行均值还是用x8I点儿来表示？但是这个时候。这个行比方说行一的均值是这一个部分啊。所有的数字加起来就均值，那么列均值呢？比如说x。
点击。比如我们现在求第二列的均值x八点二，它等于第二列啊。这些数字加起来，然后再除以它们的呃样本量。求这列的均值啊，那么这就个是行均值和列均值的含义，那么还有呢，是格子里的均值，因为现在一个格子里放的不是一个数字，是多个数字了。那么，格子的均值x8 it？就表示。第I行第I列这个格子的均值，
比如说我们现在想求。x8。二一这个值。格子的均值，那就是第二行第一列啊，是这个格子里头的这些数字的均值。啊，所以我们看总均值行均值列均值，还有格子里头的均值啊，我们要准备这几个均值。才能接下来去做这个平方和分解的工作。下面我们来看这个总平方和的分解。呃，首先来看总平方和。因为现在这个数据呢，
是个三维数据啊，所以前面呢会有三个连加，然后后面的平方是。每一个样本观察值都与总均值做差，然后平方前面的表示把这些平方连加起来啊，这个是。总的。平方和那么行因素引起的。平方和前面还是三个连加啊，不变。后面呢，因为它是行因素嘛，所以这个是行均值和总均值之间的差的平方前面。把表示把这些平方连加起来，那么在后面的这个平方上啊，
这个这一项因为它只跟I有关系。所以我们只保留I的连加，然后g和l呢，我们就直接呃把它们的连加改成常数rm，并且把rm提到前面连加符号的前面。就会得到一个这样的形式ssr呃ssc呢，它是列因素引起的。平方和那么前面还是三个连加，后面是列的均值和总均值之差的平方前面。三个连加啊，表示把这些平方和连加起来，那么后面这个只跟积有关系，所以我们只保留积的连加。I的连加写成kl的连加写成m啊k和m都挪到这个连加符号的前面，就会得到一个这样的。
形式，这是ssc那么呃交互作用。ssr cr呢，本身是行c呢，比本身是列啊，它写在一起表示行因素和r因素的。交互作用引起的这个波动，前面还是三个连加，后面大家要注意一下这个这一项啊，是格子的均值。啊格子的均值，然后减去所在行的均值，减去所在列的均值，再加上一个。总的均值，
它是这样一个构造，然后我们看后面这里。这个括号里头只跟I和g有关系，它跟l没有关系，所以我们保留前面两个连加，把最后一个连加换成m，并且提到连加符号的。前面来就会得到一个。这样的形式，这是交互作用引起的平方和那么这个交互作用引起的平方和呢？大家注意一下就是。这里头是每一个格子的。均值，然后减行均值，减列均值加总均值，
那么减行均值这个行均值实际上啊，它是在列均值的。它是在这个总均值的基础上加一个波动裂均值呢，实际上也是在总均值的基础上加一个波动。所以它在减的时候，实际上减掉了两个总均值，它要补一个回来。呃，就形成了这样一个呃交互作用。引起的平方和那么我们计算完了，总的我们也把行因素列因素呃交互作用因素引起的平方和。都提取出来之后。最后呢，就剩ss 1啊，总均值当中提取行提取列提取交互作用，
就剩了ss 1。所以我们现在也不太关心ss e，它自己的表达式是什么？我们从计算的角度来说呢？嗯，计算出这四个之后啊，这个也就。可以推算出来了，那这是总平方和的呃分解以及各个平方和该如何计算下面呢？就要计算均方。啊，计算均方之前是要确定各个平方和的自由度问题。那有交互作用的，这个双因素方差分析呢，它这个自由度呢，
就呃比较复杂了，但是我们一点点的来分析一下。呃，首先呢，这个总和的自由度，它就是n- 1，那么这个n啊，我们可以写成k×r×m。那么行因素的自由度是k- 1列因素的自由度是r- 1。然后我们这个来看一下，你如果说就是想去记一下的话，你可以去这么记啊。比如总和的自由度。它是每一个样本观察值。啊，
都要减掉一个总的均值，那么样本观察值一共有多少个呢？一共有kr m个。然后减掉一个总的均值，你就减掉一啊，这个就是。呃，总和的。自由度啊，你看到总金值如果被减掉了，你就减掉一个自由度，你看到总金值如果被加上了，你就要加一个自由度啊。那么，这个行因素呢？
我们看后面的啊。它是行均值兼总均值，行均值有多少个有多少行啊？有k行。那么，减掉总均值，你就再减掉一，这个就是行因素，平方和的自由度，那么列因素呢？跟行因素的确定是一样的，有多少？列嗯有r列，然后减掉这一个总均值，那这就是列因素的。
平衡和的自由度。那么，交互作用的呢？你看有这个是表示。格子的自由度吗？有多少个格子呢？有k×r的格子啊，因为有k行有r列。所以格子的数量是kr，就比如我们这边有两行有两列，它有多少个格子的均值啊？它有四个格子，二×2啊，有四个格子，它自然就会有四个格子的均值，
所以它是行和列的。乘积啊，表示这种均值的数量有kr个，然后我们再减掉行均值，那么行均值有多少个呢？有r个再减掉列均值啊，行均值有k个，然后再减掉列均值列均值有r个。然后再加上一个总均值，你就再加一个自由度。呃，加一个自由度，然后这个时候。我们就可以。整理一下它，
等于我们前两项。把k提出来。就是k乘上r- 1，然后后面呢？我们写成减去括号r- 1。然后这个时候r- 1和r- 1又可以提出来了，那就是k- 1乘上r- 1。那现在我们得到了。呃，这个自由度还有这三个自由度，那么最后这一个自由度呢？我们可以根据它们之间的关系，就是前四个自由度之和等于总和自由度。那么，我们用总和自由度减掉前三个的自由度，
就会得到这个ss e的自由度。或者呢，我们也可以像这样考虑一下。那么，这个kr m。这个是我们的。总的观察值的个数，然后减掉一呢是总和的自由度，我们把这个kr m。kr m看成是m个kr。m个kr那么一个kr。就表示一个矩阵。r呃k行r列每一个都是这样的，有多少个呢？有m个。
好，最后一个啊，这是第m个。我们把行列啊，表示出来，现在还是有k行有r列，那么这m个。矩阵。的格子的数量就是kr m，然后呢，我们从最后一个dm个kr当中呢，再减掉一。减掉一那么剩下的。这些。呃，
矩阵所有的格子就是总和的自由度啊，因为本来是m个kr，然后在最后这个当中呢，减掉一。那么剩下还有总共还有多少个格子？那就是总体的自由度那。是这样，然后呢？我们减去行因素的自由，度行因素的自由度不是k- 1吗？你就从边上啊。减掉k- 1，然后列因素的自由度不是r- 1吗？我们就从这边啊，消除r- 1，
那么剩下的呢？这正好就是在这个kr的矩阵当中，把行去掉，把列去掉啊，就瘦了一圈。那恰好就是k- 1 r- 1，那这个就是。交互影响的自由度，现在呢？我们。呃，把这个行因素，列因素交互影响。这个自由度都减掉了，以后等于是这个最后一个矩形就消失了。
最后一个k×r的这个矩阵就消失了，那么剩下还剩多少个呢？还剩m- 1。个kr那就是kr乘上m- 1。那这个自由度也就出来了。呃，你如果真的想记的话呢，你可以这样去分析一下，事实上，如果说呃，真的计算的时候我们知道了这一个啊，知道了这三个最后一个一减也就出来了。呃，那。我们确定了自由度呃，
就可以去计算均方了，那么计算均方的时候。平方和除以自己的自由度。得到对应的，均方除以除以。注意得到对应的均方，然后再用均方去计算f值，那这个时候我们要检验。呃行因素有没有显著影响？列因素有没有显著影响？交互性有没有这个显著的交互影响？对吧？那么行因素，我们就用行的均方除以。剩余的均方是它，
然后与这个临界值。相比较，但是你要注意自由度的问题，这个时候比如说这个的自由度是k减第一，自由度是k- 1。第二，自由度呢，是kr m减。一是这个临界值需要的自由度。那么，如果我们检验另一处呢用？列的均方msc同样比上m se。那这个时候。需要的自由度第一，自由度是r- 1，
第二，自由度还是kr m- 1。那么，这个前两个实际上呃，跟我们在做没有交互效应的时候，构造这个统计量其实是一样的。但是呢，有交互作用的时候会多了一项交互影响的军方。除以m se啊，这个它用它去检验交互效应是否显著？那么它有它啊，自己的临界值第一自由度是它。第二，自由度是它。对应去检验，
那如果说这个值大于了这个零件值，那么我们就认为。存在显著的交互效应，如果说啊，小于我们就认为这个交互效应是不存在的啊。剩下的这两个行因素列因素的这个检验跟啊，没有交互作用的时候的那个检验准则是一样的啊，同样都是。f统计量同样都是f分布，但是注意这个自由度的问题呃，然后呢呃，因为自由度不一样，它们的临界值可能不一样，这个时候就是。啊，
没有什么难的，但是要仔细一点儿，不过这个有交互效应的，这个双因素方差分析。出这个计算题啊，大题啊，概率还是比较低，因为这个东西出上，其实它没有多大意义。对，整来整去都是把这个呃障碍设置到计算上了呃，那么这个它就意义不大，但是这个。嗯，没有交互作用的双因素方差分析，
还有这个单因素方差分析各方面的，这个掌握还是要嗯，扎实一点儿，对于大部分同学来说，这个有交互效应的。双因素方差分析，实际上你作为一个这个呃了解的内容就足够了。