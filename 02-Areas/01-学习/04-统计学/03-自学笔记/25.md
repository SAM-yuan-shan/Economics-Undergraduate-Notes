# 第七章 参数估计：区间估计引入

## 点估计的局限性与区间估计的必要性

* **点估计 (Point Estimation)：**
    * 用样本统计量的一个**单一值**作为总体参数的估计。
    * **问题：** 无法衡量估计的精度或可靠性。我们知道估计值几乎不可能正好等于参数真值（对于连续变量，$P(\bar{x} = \mu) = 0$），但不知道它“有多近”。
* **需求：** 提供一个范围或区间，并说明该区间包含总体参数真值的可能性（概率）。

## 从点估计到随机区间

* **思想：** 围绕点估计量 ($\bar{x}$) 构建一个区间，例如 $[\bar{x} - E, \bar{x} + E]$ (其中 E 是一个误差范围)。
* **例子：** 考虑不等式 $|\bar{x} - \mu| \le 1$，等价于 $\bar{x} - 1 \le \mu \le \bar{x} + 1$。
    * 这定义了一个区间 $[\bar{x} - 1, \bar{x} + 1]$。
* **随机区间 (Random Interval)：**
    * 由于点估计量 ($\bar{x}$) 是一个**随机变量**，因此以此构建的区间也是一个**随机区间**，其端点是随机的，会随样本变化而变化。
    * 总体参数 ($\mu$) 是一个**固定的常数**。
* **重要区别：** 我们讨论的是**随机区间包含固定参数**的概率 ($P(\text{区间包含 } \mu)$)，而不是固定参数落入随机区间的概率。参数本身是不动的。

## 总体均值 $\mu$ 的置信区间 ($\sigma^2$ 已知)

* **目标：** 给定一个概率 $1-\alpha$ (称为**置信水平**)，找到一个随机区间 $[\hat{\theta}_L, \hat{\theta}_U]$， 使得这个区间包含参数 $\theta$ 的概率等于 $1-\alpha$。即 $P(\hat{\theta}_L \le \theta \le \hat{\theta}_U) = 1-\alpha$。
* **构建 $\mu$ 的置信区间 ($\sigma^2$ 已知) 的步骤：**
    1.  已知样本均值 $\bar{x}$ 的分布为 $N(\mu, \sigma^2/n)$。
    2.  对 $\bar{x}$ 进行标准化：$Z = \frac{\bar{x} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)$ (标准正态分布)。
    3.  找到对称区间 $[-k, k]$，使得标准正态变量 $Z$ 落入此区间的概率为 $1-\alpha$：$P(-k \le Z \le k) = 1-\alpha$。
    4.  利用标准正态分布的性质：区间外的总概率是 $\alpha$，由**等尾原则**，左右两边尾部的概率各为 $\alpha/2$。
    5.  查阅标准正态分布表或使用分位数概念：满足 $P(Z > k) = \alpha/2$ 的 $k$ 值记为 $z_{\alpha/2}$（即上 $\alpha/2$ 分位数）。则 $-k$ 对应的下 $\alpha/2$ 分位数是 $-z_{\alpha/2}$。所以 $k = z_{\alpha/2}$。
    6.  将 $k=z_{\alpha/2}$ 代回不等式 $P(-z_{\alpha/2} \le \frac{\bar{x} - \mu}{\sigma/\sqrt{n}} \le z_{\alpha/2}) = 1-\alpha$。
    7.  通过等价变换，将 $\mu$ 整理到不等式的中间：
        * $-z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \le \bar{x} - \mu \le z_{\alpha/2} \frac{\sigma}{\sqrt{n}}$
        * $-\bar{x} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \le -\mu \le -\bar{x} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}$ (各项乘以 -1)
        * $\bar{x} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \le \mu \le \bar{x} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}$ (各项乘以 -1 并反转不等号方向)
    8.  得到随机区间：$[\bar{x} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}}, \bar{x} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}]$。
    9.  这个随机区间包含总体均值 $\mu$ 的概率为 $1-\alpha$：$P(\bar{x} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}} \le \mu \le \bar{x} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}) = 1-\alpha$。

* **置信水平 (Confidence Level) 与 置信区间 (Confidence Interval)：**
    * 概率 $1-\alpha$ 称为**置信水平**或**置信度**。
    * 上述构造出的随机区间 $[\bar{x} \mp z_{\alpha/2} \frac{\sigma}{\sqrt{n}}]$ 称为总体均值 $\mu$ 的 $1-\alpha$ **置信区间**。
    * 根据一次具体抽样得到的 $\bar{x}$ 值计算出的具体区间（如 [3, 5]）称为**特定的置信区间**。

## 计算特定的置信区间

* **公式：** 根据一次抽样得到的样本均值 $\bar{x}_{特定值}$，计算特定的置信区间为 $[\bar{x}_{特定值} \mp z_{\alpha/2} \frac{\sigma}{\sqrt{n}}]$。
* **步骤：**
    1.  根据样本数据计算样本均值 $\bar{x}$。
    2.  根据给定的置信水平 $1-\alpha$，确定 $\alpha/2$。
    3.  查标准正态分布表或使用分位数找到 $z_{\alpha/2}$。
    4.  已知总体标准差 $\sigma$ 和样本量 $n$。
    5.  将这些值代入公式计算区间的上下限。
* **例题：** 正态总体，$\sigma^2=2$ ($\sigma=\sqrt{2}$)，$n=4$，样本值 $\{1, 2, 3, 4\}$。求 95% 置信水平下的 $\mu$ 的置信区间。
    1.  $\bar{x} = (1+2+3+4)/4 = 2.5$。
    2.  $1-\alpha = 0.95 \implies \alpha = 0.05 \implies \alpha/2 = 0.025$。
    3.  查表得 $z_{0.025} = 1.96$。
    4.  $\sigma = \sqrt{2}$, $n=4$。
    5.  区间为 $[2.5 - 1.96 \frac{\sqrt{2}}{\sqrt{4}}, 2.5 + 1.96 \frac{\sqrt{2}}{\sqrt{4}}]$
        $= [2.5 - 1.96 \frac{\sqrt{2}}{2}, 2.5 + 1.96 \frac{\sqrt{2}}{2}]$
        $\approx [2.5 - 1.96 \cdot 0.707, 2.5 + 1.96 \cdot 0.707] \approx [2.5 - 1.386, 2.5 + 1.386]$
        $= [1.114, 3.886]$。
    * 这是一个特定的置信区间。

## 置信区间的理解补充

* **随机区间与概率：** $P(\text{随机区间包含 } \mu) = 1-\alpha$。这描述的是**构造区间的方法**在长期重复下，包含真值的频率。
    * 图示理解：想象多次抽样，每次得到一个 $\bar{x}$ 并构造一个区间。在 1-$\alpha$ 的概率下，这个随机区间会“罩住”固定的 $\mu$。
* **特定区间与信心：** 对于一个**已经计算出来的特定区间**（如 [1.114, 3.886]），它与固定的 $\mu$ 的关系已经是**确定**的（要么包含，要么不包含），概率是 1 或 0，但这个结果我们**不知道**。
    * **不能**说 $P(1.114 \le \mu \le 3.886) = 0.95$。这种说法是错误的。
    * 此时的 0.95 (置信水平) 表示的是我们对这个特定区间包含 $\mu$ 的**信心程度**。
    * 信心的来源：这种构造区间的方法，在理论上重复进行无限次，会有 95% 的区间包含真值。我们现在得到的这个特定区间，就是以 95% 的成功率构造出来的众多区间中的一个。
* **总结：** 置信水平描述的是构造方法的可靠性，而不是某个特定区间包含参数的概率。我们有相应的信心认为特定区间包含了参数。