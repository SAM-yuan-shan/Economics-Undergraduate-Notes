大家好，今天呢，我们就进入第十章方差分析第一节单因素，方差分析那所谓的方差分析呢，就是通过分析方差。来检验多个总体均值是否全都相等的问题，那这其实还是个假设检验的问题。因为多个总体那么对总体数量的要求呢，是大于二，那我们就简单一点儿，以三个总体为例。对于是否相等的问题呢？原假设是相等缪一等于缪二等于缪三，也就是说。三个总体的均值是全都相等的。那么，
它的对立面是什么呢？是不全相等，就是在全相等的前面加一个否定。就完成了这个。规则假设啊，也就完成了对原假设的一种对立关系。大家一定要注意，这个地方是不全相等啊，并不是全部相等啊，不是这样一个描述，而是不全相等。那么，这对我们而言呢？确实确实是一个新的问题，因为我们之前只学过两个总体均值的检验。
那么现在呢？变成了多个总体，那对于我们这个例子而言，三个总体我们可不可以用我们之前学过的方法来？解决这样一个新的问题呢？因为我们之前学过，是两个总体的检验，那我们就。把这样一个。三个总体均值相等的问题呢，拆成三个两两组合，比如第一个是缪一和缪二的组合。我们检验一下它是不是相等？第二个呢，是缪一和缪三的组合，
我们检验一下是不是相等？第三个呢，是缪二和缪三的组合，我们检验一下它是不是相等？那这样的话。可不可以解决我们这个新的问题？我们可不可以对h0啊做一个判断是拒绝他还是不拒绝他？那如果我们对h0啊进行了一个分解。大家考虑一下，是不是只有这三个小h0啊？小的原因假设同时成立。啊，同时成立才能保证h0成立。啊，那么同时成立，
我们因为我们这三个小的运检设是分开做的啊，是分开做，那我们三个这个小的检验当中呢，显著性水平呢，多少阿尔法？那么，自然是拒绝h型的概率都是阿尔法，那么不拒的概率呢？都是一减阿尔法。三个原假设同时成立啊，三个小的原假设同时成立的概率是多大呢？是一减阿尔法的。三次方那也就是说我们如果分成三个小的检验区。解决我们这个新的问题的话。那么，
不拒绝h0的概率是一减阿尔法的。三次方啊。那么，不拒绝的概率是一减阿尔法三次方，因为一减阿尔法它是小于一的，所以一减阿尔法的三次方一定是小于一减阿尔法的。比如阿尔法等于零点零五，那么一减零点零五的三次方等于零点八六是小于一加阿尔法的啊，因为一加阿尔法是零点九五。那么这个是我们用这种拆开分别检验的方式，不拒绝hn的概率是一减阿尔法的N次方。那么，拒绝的概率呢？就是一减去不拒绝的概率，因为这个一减阿尔法的三次方是小于一减阿尔法的，
所以拒绝h0的这个概率。是一定大于阿尔法的，比如阿尔法等于零点零五的时候，那么这个是不拒绝的概率，我用一减去不拒绝的概率，自然就是拒绝的概率。是零点一四是大于零点零五，大于阿尔法的。那么，这是这有一个什么现象呢？就是说，虽然我们在。分开检验每一个小的检验当中，显著性别都是阿尔法，但是综合起来看，
拒绝h0的概率会上升，会大于阿尔法。那么，阿尔法是什么？阿尔法是犯一型错误的概率啊，那么虽然说分开检验每一个小的检验犯一型错误的概率都是阿尔法。但是我们综合起来对h0进行判断的时候，我们犯一行错误的概率呢，会上升啊，就会大于阿尔法。而且随着。总体数量的增加两两组合也会变多，那么两两组合变多意味着拒绝h0的概率。上边的啊，这个指数啊，
它也是会上升，它一上升就导致不拒绝的概率下降。导致拒绝的概率呢上升，那么也就是说。呃，随着这个总体数量的变多，我们如果还是用这种两两组合的方式对这样一个假设做判断的话，我们这个。这个犯一型错误的概率呢，还会继续增加啊，那么这个是它会导致犯一型错误概率增加的，这样一个缺点。同时呢，这个两两组合，它还很繁琐啊。
那么，这是这个三个总体，我们有三种组合，四个总体就有六种组合，五个总体就是十种组合，你再往上那组合是更多了。所以如果我们啊用这个老方法去解决新问题，一个它会很繁琐，另外一个呢，会导致犯疫情错误的概率增加。那么，而我们接下来要学习的方差，分析的方法呢？是从整体考虑问题，他们都会说拆开去解它，
是整体考虑问题。可以克服啊，这种方法的缺点。下面我们来看方差分析当中的基本假定，那这个所谓的基本假定呢，是我们使用方差分析的一个前提。左边的表格当中，三列分别表示来自三个总体的样本。三个总体的样本的样本量分别是n1n2和n3啊，那这个n1n2n3呢？它是可以不相等，它也是可以相等的啊，这个都没有关系。基本假定的第一条啊是每个总体都服从正态分布。第二条呢，
是每个总体的方差，必须相同，也就是说第一个总体的方差sigma 1方等于。sigma 2方等于sigma 3方，我们就记为sigma方，那么第三条呢？是观测值是独立的，也就是说在。就所有的。样本当中。任何一个与其他的观察值都是独立的啊，这是独立性，那么在这三个基本假定之下，我们可以知道。这个观察值，
它其实是服从正态分布。啊sigma方是一个共同的方差，因为每个总体方差呢是相同的，但是呢，它们的均值是不一样的。我们这里的这个I呢，表示是第几列啊？第几列比如说x1g。一及表示第一列的方差值，那么它就服从正态分布均值是缪一方差是c码平方。如果是x2级，它也是服从正态分布，那么方差还是一样的，但是。均值就不一样了啊，
这个是这个含义，那么在这个前提假定之下，我们还可以把三个总体呢？放到这张图上。都是正态，总体方差，还相同，意味着这三条曲线的高矮胖瘦是一样的，但是。均值不一定相同呢，就导致曲线的位置不一定相同，所以呢，这个时候三条曲线可能是错开的。那么，在这个基础上，
如果我们假定h0是成立的，那既然成立呢？我们把这个均值呢？就表表示成缪就可以了啊。那如果h0成立会发生什么呢啊？刚才他们错开的原因就是因为均值并不一定是相同的。那么，现在如果均值相同了，这三条曲线就会合三为一啊，就会重合了。所以这个是我们啊，从基本假定当中啊，得到的一个。结论啊，基本假定，
如果满足了啊，而且原假设成立了。那么，三个总体的曲线是重合了，那重合着意味着其实这三个总体它是一个总体。啊，它就合成一个总体了，那么我们的三个样本呢？其实就源于一个总体的三次抽样啊，当然了，这个一定要注意它是。在原假设成立的条件下，才满足我们刚才的这样一个描述啊，三个总体合三为一啊，变成了一个总体。
那么，原来三个总体的样本就变成从一个总体当中抽样三次。下面呢，我们就进入方差分析的核心部分，那我们刚才提到的方差分析呢，就是通过分析方差来检验多个总体均值是否全都相等。那方差分析其实就是对这个样本波动的分析，我们用这个样本为例啊，还是来自三个总体的三个样本。样本量分别是n1n2n三样本，总量是n 1+n二+n三，我们记为n。这个是样本总量，如果我们对所有的样本。求和，
然后再除以n就会得到一个总的均值那分子上啊，就是对所有的样本进行求和。然后分母上除，以n这个被称为总的均值。然后呢？这三个样本还有各自的均值，我们记为xi一八，那么xi一八。代表第I列的均值，那如果是x一一八呢？就是第一列的均值。第二列的均值。x二一八第三列x三一八，那么这是两种均值，一个是总均值。
另外一个呢是三个样本，各自的均值。那这个。平方它在表示什么呢？它其实就是在表示总的波动就每一个样本与总的均值的差的平方。然后再求和它表示了。所有样本放在一起的，总的波动的情况，那么我们对。这个叉呢，做一个变换就是。在x ig的基础上减掉一个xi 8，再加上一个xi 8，保持等式的成立。然后呢？
我们把。这四项合并成两项，然后把平方打开，在打开的时候呢？有它的平方项，有它的平方项，那事实上它应应该有一个交叉项。但是交叉项等于零，所以就在这个等式当中消失了，那我们来看一下为什么这个交叉项是等于零呢？比如，当I=1的时候，哎，就是说当I=1的时候，这个这个连加符号就消失了，
后面呢，对在I=1的时候呢，进行一个连加。我们看g=1到n1啊，也就是说I=1的时候的样本量进行一个。连加那么在这个时候x一八和x八八那么这两个均值跟七都是没有关系的。所以还有还有二也跟记忆没有关系，都不会随着记的变化而变化，所以这些这两个我们可以提到连加符号的前面来。后面的这个连加大家看是什么？后面的这个连加事实上就是第一列的离均差之和。那么，离均差之和是等于？零的啊，所以呢。
这个乘积就等于零，那么当I=1的时候，后面连加等于零，当I=2，等于三的时候，后面这个连加都是一样的啊，都等于零。所以这个总体来看，这个交乘项呢，它就是等于零的，所以在这个展开的式子当中，交乘项消失了，是因为它等于零。那有的同学可能对这个两个连加符号在一起的运算不熟悉，我们简单说一下啊，
就以这个式子为例，我们看这个连加符号在说什么？那这个是样本啊，这个呢是两个连加符号里边呢，是x ig减去总的均值。它其实就相当于当I=1的时候。计算后面这个连加。啊，等于它当I=2的时候。计算后面这个连加等于它。当I=3的时候呢，还是计算后面这个连加等于它，然后再把这三个连加求求和加起来。啊，就是这两个连加符号在一起，
它们的这个计算规则。那好，现在呢？我们事实上把这个总的波动分解成了两种波动。啊，两种波动在方差分析当中呢，他们都有自己的名字和标记，我们来看一下。总平方和。每一个观察值与总均值之差的平方和它衡量的是这个样本整体的。总波动情况啊，那么这一项。ss e啊。是主内平方和主内平方和。在干什么呢？
我们看x ig和它所在的这一列的均值。差的平方，它实际上这个连加再衡量什么分别计算三组的。波总波动。然后再把它们加起来。啊，它其实衡量的是组内的波动，那么这个是总的波动。作为s ST组内的波动呢，是ss 1。最后呢，这个称为组间波动，那么它衡量的是什么呢？这每一列的均值与总均值之差的。平方和它衡量的，
实际上你可以理解成不同的。样本均值。啊，这三个之间的总波动，它是在衡量这个问题，所以呢，它是组间波动。主键波动。那么，总平方和我们称为啊，即为s ST。然后主内平方和，即为ss 1主间平方和，即为ssa。由于这个等式的存在，
所以s ST。等于。ss e再加上ssa啊，这个是三个平方和之间的关系。下面呢，我们就详细的分析一下这三个平方和首先来看总平方和。那么，在前提假定中，要求每个总体都是正态，总体方差相同并且独立。那么，如果这个时候原假设是成立的，意味着这三个总体都是。正态总体均值和方差都相同，那这三个总体其实就变成了一个总体啊，
这个是我们在。讲前提，假定当中讲过的内容，那这三个样本呢？就来源于同样一个总体。那么，总平方和中的总均值的分子啊？你看他写的两个连加符号，它其实意思就是我先对第一列连加，然后再对第二列连加，再对第三列连加再求和。那这个意思不就是对所有的样本求和吗？对吧，那现在呢？我们把样本一二三忽略掉，
就把它看成是一个样本。我们对这个所有的样本进行编号以后呢？因为样本量是n 1+n二+n三=n啊，样本量就是n，所以编号一定是一到n。那我们把一二样本一二三忽略掉对。所有的样本求和就可以写成这个样子，然后分母上呢，都是除以n。那所以我们熟悉的这个样本均值跟这个总均值啊，它其实是一回事儿啊，它是相等的。那么，总的平方和s ST写成这种形式，跟写成这种形式，
它也是一回事啊，它其实是。一样的啊，一样的，那么这个是什么呢？这个就是说我们不区分样本一二三啊。不区分样本一二三，然后呢，对所有的样本看成是一个样本，然后呢，求它们的总的。离均差平方和啊，离均差平方和那么离均差的平方和跟谁相关系啊？啊，有关系啊，
跟样本方差有关系对吧，所以我们在这样一个基础上乘以一个。这个一项，然后再除以这一项能够保持等号的成立，那么。总的平方和啊，总的离群差平方和比上自由度n- 1。n- 1，这是谁呢啊？这一项。就是s平方就是样本方差，所以我们进一步整理之后就会得到一个这样的形式啊。sigma方下面是n- 1倍的s方啊，分母上还有一个sigma方，那么sigma方我们不把它约掉啊，
因为后面这样一个构造。它是服从它方分布自由度是n- 1的啊，所以现在这个s ST总的平方和。实际上，我们可以表示成一个sigma方乘上一个car方。n- 1啊，这种形式。我们继续看组内平方和ss e，那么组内平方和呢？它是一种这种表达方式。实际上，他在做什么？sig减去它所在列的均值，然后做差啊，然后平方，
其实它求的就是每一列的。离均差的平方和的和啊。然后我们呢，根据这个运算规则，当I=1的时候计算后面这个连加啊，这是第一列的离均差之和。当I=2的时候呢，我们还是计算后面这个连加等于它当I=3的时候呢，我们还是计算后面这个连加。然后把三个加起来啊，就得ss e了，那么这个每一项其实都是每一列的离均差之和。那么，这又得到了离群差之和，我们看第一项，
它是第一列的离群差之和。我们按照刚才同样的操作。我们乘上一个sigma方，乘以n1-1啊，因为第一列它的样本量是n1，然后呢，我们同时除以这一项保持这个等号的成立。然后这个部分。就是第一列的样本方差s1方啊，我们还是整理成这个样子。整理成这个样子呢，后面它不又有一个开方分布了吗？自由度是n1-1。那么，第二项，
第三项我们同样的操作。就会找到后面两个卡方分布，比如说我们对第二项进行整理的时候。它结果就是sigma平方n2-1。s2的平方比上sigma方，那也就是。这一项啊，服从开方n2-1。那么第三项呢？也可以同样的整理，我们把它们加起来，把sigma方提出来之后，括号里面就剩三个咖方分布的和。那么，由于独立性和咖方分布的可加性，
我们知道这三个咖方分布的和还是咖方分布？也就是说，括号里边这一部分，它其实还是开放分布。自由度是什么呢？自由度是三个咖方分布的自由度之和，那就是n一减一加n二减一加n三减一。那么，因为n 1+n二+n三=n啊，后面再减三嗯，自由度就是n- 3。啊，所以现在ss e啊组内的平方格，我们可以表示成一个sigma平方。乘上一个卡方n- 3。
啊，这种形式。最后，我们来看组间平方和。ssa啊，由于这个三个平方和呢，它们存在这样一个关系，在原假设成立的时候。s ST可以表示成这个样子。ss e呢可以表示成。这个样子。大家注意一下，这个s ST它可以表示成这种形式有个前提啊，是原假设要成立。但是ss e表示成这个形式跟原假设是没有关系的啊，
那么ssa是什么呢？那现在我们猜测一下，因为这两项都带着sigma平方，那我们就猜ssa应该也有一个sigma平方。那么，系统的平方，如果我们给它约掉以后啊，剩下的就是咖方分布，如果这个地方是咖。方二的话，那么由于开方分布的可加性n- 3。加二不就等于n- 1吗？啊，这个时候如果这个地方是个k方二啊sic如果是。可以表示成一个sigma平方乘上一个k方二啊，
在我们看来。啊，是一个比较合理的事情，但是呢。这这是我们的猜测啊，这是我们的猜测，那我们猜的对不对呢？结论是我们猜的是对的啊。啊，但这不是严格的证明啊，因为开方分布有可加性，但是没有可减性。从原理上来说，如果我们知道了这两个。啊，
是可以推这个。但是如果我们知道的是这两个。啊，是推不出ssa的。也就是说，这个ssa可以表示成西格玛方乘上咖方二是我们猜的，或者说是凑出来的。只不过是猜对了而已。啊，这个是有点儿投机取巧，但是如果我们就从正面刚，我们就要通过ssa它具体的表达式。找然后呃，推出这样一种表示方法，那就太难了啊，
这个一般的数理统计的教材也不会讲。就超出我们这这本书的要求太多了啊。我们继续啊，我们猜对了ssa可以表示成一个斯格玛方乘上卡方二。那现在呢？我们用ssa除以对应的自由度二用ss e除上堆呢？自由度三然后呢？啊，这两个做比值。因为ssa可以表示成sigma方乘上卡方2 ss e呢，也是sigma方乘上卡方n- 3。那么，这两个sigma方就约掉了，剩下的是什么呢？剩下的分母分子上是卡方二除以自由度二分母上是卡方n- 3除以自由度n- 3。
那就恰好就是f分布。l分布呢，有两个自由度，第一个自由度跟分子上的卡方分布的自由度相同，第二个自由度跟分母上的卡方分布的自由度相同。所以呢，fn不等于自由度，分别是二和。n- 3。那到此为止呢，实际上我们就在原假设成立的条件下得到了一个检验统计量。它服从f分布。好那么ssa除上对应的自由度，我们记为msa。ss e呢，
除摄像对应的自由度，我们记为ss e啊，那么MS这个m啊，它是。这个平均的意思。ssa那是组内的，这是组间的呃，这个平方和msa呢，就是组间的均方。啊m se呢ss e啊ss e是组内的平方，和那么m se啊代表组内的均方啊，这两个是均放。msa是祖先群芳msa女士。主内均方那么这两个均方的比值。是服从f分布啊。
这个自由度的问题啊，大家注意一下。那到现在为止呢，我们通过分析三种平方和啊，找到了一个检验统计量。f检验统计量，它服从f分布，那么跟所有的检验统计量一样，我们都要找到背离原假设的方向，并且根据显著性水平。确定拒绝率和临界值啊，下面我们就来看一下这个检验的准则。那么，左上这张图呢？就是原假设成立的时候。
三个总体的分布重合了图像，那右边呢？是原假设成立的时候，我们构造的啊。f减统计量的分布，那我们要找到背离原假设的方向，才能确定拒绝域和临界值。以往我们检验总体均值是不是相等的问题呢？拒绝率在双侧，但是方差分析不同啊，它的拒绝率是单侧的，我们来看一下原因。那如果原假设不成立。那意味着，这三个总体并不重合，
它们的曲线会错开，曲线位置不一样那么。它会影响。ssa啊，我们看一下为什么呢？因为如果h0是成立的，那么这三个样本均值。它会围绕在共同的总体均值旁边，也就是说。三个样本均值x一八。x2吧x3吧，它们会围绕在共同的均值附近。那如果h0不成立呢？三个样本均值会在各自总体均值附近，也就是x1，
它可能啊，在这儿x2。二八在这儿x三八在这儿，那么这就会导致样本均值之间的。波动变大，而这个组间。组间的波动ssa衡量呢？其实就是。这样本均值之间的波动h0成立的时候，它们有共同的总体均值，它们的波动是这样。如果h0不成立，它们就围绕在各自的总体均值附近，那么它们的波动呢？就会变大啊，
就会导致ssa变大。它会不会影响这个ss e呢？它不会影响ss e，因为本来ss e的分析就没有用到原假设。而且ss e它衡量的是组内的波动。啊，组内的波动，也就是说每个组都算自己的，然后再相加，那在算自己的组内波动的时候呢，与其他组的样本根本就没有关系。那比如，原假设成立的时候。啊，这个比比如说这个第一列样本，
它可能在这儿，它自己有一个种类的波动。嗯，原点是不成立的时候呢，它可能在这儿啊，它有一个自己组内的波动，其他三个呢，也是一样的。啊，也是一样的，比方说这是三个总体。它们的波动，它们本身在h0成立的时候是自己算自己的，然后再求和。那即使h0不成立啊，
第二个样本可能在这儿啊，第三个样本可能在这儿。它实际上还是自己算自己的，再求和。啊，所以呢，它对这个组内的总波动，它是没有影响的，即使hn不成立啊，它对ss e是没有影响的。那么s在h0不成立，不成立的时候ssa会上升ss e是不变的。它不变，那么就会导致MS 1上升，MS 1不变就会导致。
这个检验统计量上升。啊，所以。从整体上来看，如果这个原假设不成立f统计量是会变大的，所以右边才是背离原假设的方向。那么，对于显著性水平，阿尔法我们从右边划走啊，这个面积是阿尔法对应的。取值范围就是拒绝域，那么这个临界值啊，根据分位数的定义。就是它，但是呢，
你一定要注意一点，一定要把msa放在分子上。把m se放到分母上。也就是说，把原假设不成立时会变大的那个放在分子上啊，这会这才是右侧检验。啊，当然理论上来讲，你说我就是想把msa放到分母上啊，把m se放到分子上。这也不是不行，但是按照我们现在的默认的规则，就是这样放啊，就是这样放，如果你不是被。
这个强制要求交换，你就永远不要交换，然后对在做检验的时候对它它的这个是右侧检验。那接下来呢，我们把这个呃方向分析呢，进行一个一般化，也就是说对我们刚才。分析的这个内容呢，做一个总结，刚才呢，我们是分析三个总体均值是否相等的问题。我们现在呢，一般化成k个总体均值是不是相等的问题对应的呢？我们会得到k个样本。分别来自k个总体，
它们的样本量可以不可以不一样啊ni就表示第I个样本的。样本量那么在原假设成立的条件下，我们会得到这个f统计量。呃，两个自由度分别是k- 1和n-k，那么k是谁呢？k就是这个总体的数量n是谁呢？n就是总的样本量。总的样本量就是从n 1+n二一直加到nk啊，等于n。那我们刚才由于k=3啊n。k=3啊，所以这个之前自由度是二和n- 3啊，它实际上二的来源就是k- 1。然后n- 3的来源呢，
就是n-k，那如果是四个总体k=4，那么这个自由度就是三。n- 4。这个是自由度的问题呃，然后呢？我们要根据这个统计量。和这个样本数据来计算一个具体的检验统计量的值啊，这个就需要。ssa和ss e啊，然后用检验统计量的值和临界值做比较，由于是右侧检验，当我们计算的检验统计量的值。f值大于临界值的时候，我们就拒绝原假设啊，
这里头说一个这个ssa的问题。因为这个是两个连加嘛，但是后面的这个连加的项啊，它跟机是没有关系的。啊，基于如何变化，它都等于。啊，这样一个值，所以我们把后面这一项就写成了ni倍的这一项。啊，这个在计算的时候呢？会方便一些嗯，同时呢，我们还把这个s ST放在了这里，
这个就是要提醒大家一下，因为s ST=ssa+ss一。所以我们计算的时候，虽然说我们需要的是ssa和ss e，但是有的时候这个这两项当中可能有一项特别难计算。那我们可能会啊，计算s ST和ssa，然后呢，通过一个相减就得到了ss e啊。啊，这个时候呢，就是需要这个按实际情况灵活处理了。我们接下来看一看这个书上的这道例题啊，由于这个小数位数的问题啊，我的计算结果呢，
跟书上的有点差异。但是呢，没有影响结论，大家注意一下呃，我们先忽略这个题目的实际背景，就把它当成一个纯粹的统计问题。那我们得到的样本数据是不同行业里的，不同企业的被投诉数量，那么要解决的问题呢？就是说。呃，检验一下这四个行业的被投诉数量的均值是否相等？根据样本来。判断啊，四个总体的均值是不是相等啊？
这就是我们要面临的一个统计问题，那么根据我们刚才的讲解呢，我们需要。计算一个这样的检验统计量，那么此时呢k=4。n等于。七六五五加起来啊，等于23那么七六五五呢？是呃对应的呃各个行业的。样本量，它们的和就是总样本量等于23。那么，我们需要计算。这个检验统计量现在呢k- 1和n-k都已经得到了，分别是三。
和19下面呢，就要计算ssa和ss e，那么ssa和ss e我们需要用到。啊，每一列的样本均值以及总的均值呃，我们在这个表中标出来了，第一列零售业，它的均值是49，它的计算方法呢，就是这一列加起来除以七。啊，等于49。那么，其他的旅游业的均值48，航空业均值35，
家电业，航空，家电业啊，均值59。总的均值呢，就是都加起来除以23啊，得到的是四十七点八七。下面我们这个两种均值都得到了，我们看一下sic和ss e具体是如何计算的？首先ssa啊，它是一个这样的形式，当I=1的时候，样本量ni=7啊n1=7。就是七倍的，后面呢？
x一把啊样啊，当I=1的时候，第一列的样本均值等于49，总均值等于四十七点八七。啊，这就是当I=1的时候，这个连加的结果，那么当I=2的时候呢？n2=6。第二列的均值48。总均值还是四十七点八七啊，代进去这个就是ti=2的时候。后面的这个乘积I=3 I=4，都是同样的计算方法啊，最后会得到ssa是一四四八。
那么ss e呢？当I=1的时候。I=1的时候计算后面的连加，其实就是计算第一列的阻内的总波动，那也就是。57减去这一列的样本均值49平方，然后再加上。第二项如果写的话就是66-49括号的平方啊，就是第二个数字减去这一列的均值。括号的平方一直加到这一列的最后一项44-49，括号的平方，那么这个是i=1的时候。那么I=2的时候呢？68减对应的均值48括号平方，然后再加。
39-48括的平方一直加到51-48括号的平方，那就是i=2的时候。那么I=3，等于四也是同样的计算方法，最后结果呢，是二七零八。那我们现在就得到了。s sasse，然后我们用已知k- 1和n-k，我们就可以计算检验统计量的值了。那么，依据ssa是一四四八对应的，这个k减一自由度是四减一，我们得到msa的值啊。啊，
同样的道理ss e减除以自由度，我们就得到了。m se具体的值那么msa比上m se啊，它构成了一个f分布，然后我们计算它具体的值是三点三九。那这个是我们计算的检验统计量的，具体的值。那么，显著性水平是零点零五的时候，这个临界值是三点一三。三点一三由于是右侧检验。而且我们计算的f值是大于这个临界值的啊，所以我们在阿尔法等于零点零五的水平上拒绝原假设啊。具体影响设啊，就意味着这个四个行业被投诉数量的均值呢，
是不全相等的。那这个就是呃，这一道例题的呃，这个解答的一个流程。呃，大家注意的一点呢，还是这这个自由度的问题，然后呢，就是临界值啊，这个你不用操心，它一定会。给你呃，这个值或者说呢，他也会给你线索，让你得到这个值啊，
不需要你自己去计算。那我们很多时候呢，也会把我们做方差分析的过程和一些关键的信息呢？总结的一张表上啊，叫做方差分析表，这个表呢，第一列表明的是误差来源，也就是平方和的来源。包括组件组内和总和，那么第二第二列呢？是对应的不同来源的平方和的值啊。分别是s sasse和s ST。呃，第三列呢？是对应的平方和的自由度，
分别是k- 1 n-k和n- 1。那么这这里头呢？大家要注意一下，就是ssa+ss e=SSD。那么，自由度呢？k- 1+n-k也等于n- 1。第三列呢，是军方。军方是什么呢？就是组间平方和除以它的自由度，就得组间军方。组内的平方和除以它的自由度，就得组内的均方，然后这一列是。
是msa比m se就会得到一个检验统计量的值啊，是根我们根据样本数据计算得来的。那最后这个p值和临界值临界值，它是肯定会给我们的嗯p值呢，这个大家也不用担心啊，它不是不会。考察这个p值的计算的。那么，我们把上面四个行业的例子当中的数据啊，填在这个表上啊，就是这样一个结果。那么，这个结果呢？实际上呃，就是它很简洁清晰明了啊，
就知道这个。嗯，检验的呃，各个的数据是多少啊？组间组内这个平方和是多少？然后这个计算的。呃f值是多少？临界值是多少啊？一对比也就知道了，这样的一个最后的一个决策结果。我们刚才做这道例题的时候，就是行业和投诉次数，这道例题的时候呃讲过，说我们先忽略它的实际含义，只作为统计问题来解决啊。
就简单的做一个方差分析，那现在我们来看一下啊，它的实际含义是什么？我们做的这个方差分析做的这个统计检验。具体解决了什么样的问题呢？那不同行业的被投诉数量是否相同？其实就是行业。对被投诉数量有没有显著影响，而行业是一个分类变量。它有四个取值，那么投诉数量呢？它是数值型变量，所以我们也可以说方差分析检验的是分类变量，对数值型变量有没有显著影响？那么，
在方差分析当中啊，这个分类变量，比如行业啊，称为因素或者因子。那这个行业的具体表现啊，分类变量的具体表现，或者说我们说这个啊，分类变量的。取值不同，取值称为这个因素的水平或者处理。那我们只研究了一个分类变量，对数值型变量的影响，所以以上我们的研我们研究的这个方差分析。就被称为单因素框架分析啊，因为只有一个分类变量行业。
那在方差分析中呢？原假设那么直观的含义就是说呃k个总体的均值是相等的。那背后的含义其实就是某个分类变量对某个数值型变量没有显著性影响，那么它的倍则假设是k个总体均值不全相等。背后的含义其实就是某个分类变量对某个数值型变量有显著的影响，那比如我们这个例子当中肥料。和这个亩产量。那肥料啊，它是分类变量，它是因素啊，那么亩产量呢，它是数值型变量。那肥料有四种肥料，一二三四。啊，
就是水平或者处理。那数值型变量啊，是亩产量，我们研究的是肥料对亩产量有没有显著影响？所以我们的原假设，如果我们写成mue等于到MU 4啊，到MU 4根据这个例子。那我们实际上背后研究的是什么？原假设它背后的含义就是。肥料对。这个亩产量没有显著影响。那么，贝泽假设是不全相等，它背后的含义就是肥料对亩产量有显著影响。那么，
在方差分析中，如果我们拒绝了原假设，我们认为各个总体均值不相等，就意味着我们认为分类变量对数值型变量是有影响的。分类变量与数值型变量之间是有关系的，那么这个关系的强度如何测量呢？我们来看一下这个测量方式，我们还是基于总平方和的分解，那么其中ssa它是组间的波动。衡量的是某个因素不同水平下均值之间的。波动情况，所以这个波动呢，它体现的是分类变量的影响啊，不同的水平之下，这个样本均值它的水平不一样。
而这个不同均值之间的波动呢，其实是体现的这个因素带来的影响，这个分类变量带来的影响。而ss e呢，它只是衡量组间的组内的波动啊，它是各个组各求各的，然后再相加。那么，这个分类变量的变化呢？是不会影响组内的波动的，所以这个波动不体现它不体现分类变量的影响。那么，在这三个波动当中。s ST是总波动ssa呢，它体现分类变量的影响，
所以我们用ssa。啊，去除以这个总波动得到一个比值称为r方，那么这个r方实际上就是。在总波动当中啊，分类变量变化引起的波动的比例就是在总波动当中啊，分类变量可以解释的那一部分的占比。那这个占比我们即为r方，当然这个r方。它是大于零，小于一的。那么然后我们开根号计算r用这个r来衡量关系的强度。啊，比如说上面行业和投诉量的例子当中，我们可以计算r方。
等于零点三五等于35%，那就是说，在总波动当中，有35%是可以由这个分类变量，也就是行业。来解释的那么剩下的65%呢，是其他因素引起的，是行业不能解释的。那么r开根号得零点五九啊，说明行业这个分类变量与投诉数量，这个数值型变量之间。存在中等以上的相关关系。我们最后来看一下这个多重比较。当我们拒绝原假设以后呢，就只能说明啊，
多个总体均值不全相等啊，但是并不知道具体哪些总体均值不相等。所以在这个方差分析之后，往往还要进行一个多重比较来检验，具体是哪些总体均值之间是不相等的。那多重比较呢呃，就是所有总体均值的两两组合分别进行检验。比如说这个我们有三个总体k=3的时候。我们拒绝了演讲社之后，我们要对缪一，缪一和缪二这个组合，缪一和缪三这个组合，缪二和缪三这个组合分别进行检验。那我们来看一下怎么解决这样一个问题啊，因为在基本假定当中呢，
每个总体。啊，它都是服从正态分布的方差相同，并且独立，那么呃，每个总体对应的样本均值呢？它也是服从。正态分布的。对应的总体距离就是缪I，然后呢，方差是ni分之sigma方啊，这个ni呢代表第二个样本的。样本量。因为这个假定当中有同方差的假定啊，所以这个sigma方呢啊，
不管x。几啊，这个sigma方是不会变的，它是不带下标的那么任意，两个样本均值的差。啊，它也附送正态分布均值是两个均值的差方，差是两个方差的和。然后我们进行一个标准化呃，标准化以后的这个变量呢，它不是一个可以直接使用的检验统计量。因为总体我们现在是未知的啊，只知道它们是相等，但是未知啊就不能直接用。那么，
未知情况下，我们想到的办法就是用样本信息对这个未知的总体方差进行替换。现在的问题是用什么信息来进行替换呢？在我们这个之前遇到这个两个总体方差未知，但相等的时候，我们是怎么做的呢？x一把减x二把减去u1-u二。啊，两个总体的时候比上。n一分之sigma方加n二分之sigma方。两个总体的时候均值未知，但相等我们用的是一个合并方差。样本的合并方差去代替这个西格玛方。啊，然后啊，
就是得到这样一个式子，它服从t分布。那么，这个合并的方差的构造呢？是两个样本方差的加权平均。这个是我们在啊，只有两个总体的时候如此操作的，那么现在我们是多个总体。有没有一种类似的替换方式呢啊？因为两个总体的时候也是未知。但相等。多个总体的时候，其实也是未知，但是相等有没有这个一个合适的量啊？就类似于这个合并方差。
去代替这个未知但相等的总体方差sigma方呢？是有的。那这个在方差分析当中，类似这个合并方差的量，其实就是这个m se啊，我们看m se之前呢，先看ss e。ss e呢？它是组内的。波动啊，当I=1的时候，也就是第一组组内的波动是它第二组组内的总波动是它。最后一组，中间最最总波动是它。那么，
我们以第一个为例。因为这个总波动。如果我们除以样本量n- 1，其实就是样本方差，所以这个总波动部分可以写成。样本量减一倍的。样本方差，所以。当I=1的时候，第一个样本。它的总波动我们可以写成n- 1倍的。样本一的样乘上样本一的，这个样本方差，然后第二个当I=2的时候就是。第二个。
样本的样本方差啊，乘上样本量减一。那每个都这样操作，然后呢m se是在ss e的基础上除以了一个自由度n-k。那么n-k其实就是啊，它们的和等于nn-k，那我们看一下，现在实际上m se就是。方差分析当中的全样本方差，它用每个样本的加权平均啊，作为对总体。sigma方的一个估计。啊，因为用任何一个的话都会损失信息啊，所以呢？
我们就把所有的样本方差。的加权平均啊，作为共同的sigma方的一个估计，那么这种估计它是一个最佳的估计。所以我们找到了一个在两个样本情况下，类似于啊，类似于这个SP方合并方差的一个东西是。m se.然后怎么办呢？用m se。去替换。未知，但相等的这个sigma方。然后呢？把m se啊？
提出来之后。变成一个这样的形式，它服从t分布自由度是n-k啊，自由度就是。n一减一加n二减一一直加到nk减一啊。自由度是n-k。那么现在我们就得到了一个检验统计量，事实上就是用m se去替换。位置带相等的那个sigma方。那么，我们针对这个。任何一对儿组合啊，做出一个这样的假设相等或者不相等，它从从分布。那么，
按照我们的检验规则。这是个双色检验。拒绝域在两侧啊，中间是零，所以呢，在原假设成立的时候，这边是零啊，就没有了，就消掉了。然后给它加上绝对值用这个。t方是t2分之阿尔法，也就说当这个绝对值大于这个临界值的时候。我们就拒绝原假设。拒绝假设，然后我们把这个。
分母啊，乘到这边来。把它记成临界值啊，乘以这个根号。等于lsd。那么这个。检验统计量，如果大于这个临界值，就意味着这个差的绝对值是大于lsd的。嗯，所以我们在多重比较的时候。当这个差的绝对值大于lsd，我们就拒绝原假设认为这两个总体均值是不相等的。好，我们就来演示一下，
这个是我们这个行业和投诉量的例子当中。我们这个涉及到的信息啊，那个样本样本均值啊，样本量啊啊，自由度啊，零件值啊，还有计算得到的这个m se。假设现在我们想检验的是缪r和缪三之间的关系，到底相等还是不相等？我们要计算啊，两个样本均值的差。分别是48和35啊，绝对值等于13，然后呢，我们还要计算这个lsd啊，
就是它。临界值。好，然后m se。mac是一百四十三点五三，然后两个样本分别是。呃n2n3啊六和五六分之一五分之一啊，代进去得十五点一八。最后比较的时候就是。用样本均值差的绝对值跟这个lsd去比较，如果大于等于lsd，我们就拒绝。但是我们计算出来的这个呢，是13小于十五点一八啊，它小于lsd，
所以我们就不拒绝。啊，这个是多重比较，但是呢，我们在多重比较当中呢，我们只演示了一个事实上呢，这四个当中的两两组合都要如此的去检验。比如这个一缪一缪二一三一四二三二四三四。这些两种组合总共六种啊，我们只做了这一种，那么剩下在做的时候。这个临界值t2分之阿尔法，这个是共用的啊m se也是共用的。那你剩下的就不够用了，剩下的这个嗯就要分总体。
啊，这个。组合的情况了啊，它们各自的样本均值啊。还有各自的文本量。带你去算啊。总之就是最后的这个比较的规则，就是样本差的。样本均值差的。绝对值啊，和lsd进行比较。有些是t2分之阿尔法临界值共用m se共用，剩下的这些。取值啊，就看是哪种组合了啊，
分别代进去算代进去算呢，你会得到六种假设检验，然后对应六种结果。那么结果就会告诉你。依据这个判断方法。到底是谁和谁之间的总体均值是不相等的，谁和谁的之间呢？是相等的啊，当然也有可能是全部相等的。好，这个就是我们单因素方差的方差分析的内容。